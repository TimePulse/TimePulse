- set_headline  "Listing Users' Hours"
= javascript_include_tag "/flot/jquery.flot.js"
= javascript_include_tag "/flot/jquery.flot.symbol.js"
= javascript_include_tag "/flot/jquery.flot.axislabels.js"

.button-wrap
  %div.button.radius#all-user-hours-btn
    All
  %div.button.radius#total-user-hours-btn
    Total
  %div.button.radius#billable-user-hours-btn
    Billable
  %div.button.radius#unbillable-user-hours-btn
    Unbillable

= form_tag hours_reports_path do
  %div.input-container
    %p Start Date
    %input.american_date_entry#start-datepicker{:type => "text", :name => "start_date", :value => @start_date}
  %div.input-container
    %p End Date
    %input.american_date_entry#end-datepicker{:type => "text", :name => "end_date", :value => @end_date}
  = submit_tag "Submit", :id => 'datepicker-submit-btn'

= tabbed_panel do |tp|
  = tp.add_tab('Table') do
    %table.listing
      %tr.week_row
        %td
        - @sundays.each do |sun|
          %td
            %h2= 'Week ending ' + sun
      - @users.each do |u|
        %tr.user_row
          %td
            %h2= u.name
          - billable = WorkUnitQuery.new(u,@sundays[0],@sundays[@sundays.length-1],'billable').hours
          - unbillable = WorkUnitQuery.new(u,@sundays[0],@sundays[@sundays.length-1],'unbillable').hours
          - total = WorkUnitQuery.new(u,@sundays[0],@sundays[@sundays.length-1],'total').hours
          - (0..@sundays.length-1).each do |week|
            %td
              - if billable[week].nil?
                %div.billable 0.0
              - else
                %div.billable= billable[week][:hours]
              - if unbillable[week].nil?
                %div.unbillable 0.0
              - else
                %div.unbillable= unbillable[week][:hours]
              - if total[week].nil?
                %div.total 0.0
              - else
                %div.total= total[week][:hours]

  = tp.add_tab('Graph') do
    #total-graph-container{ :style => 'width:1000px;height:550px;' }
    #billable-graph-container{ :style => 'width:1000px;height:550px;display:none;' }
    #unbillable-graph-container{ :style => 'width:1000px;height:550px;display:none;' }
